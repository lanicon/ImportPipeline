<?xml version="1.0" encoding="utf-8" ?>
<root>
   <tempdir dir="temp" clearonstart="true" />
   <endpoints>
      <endpoint name="es" type="ESEndPoint" url="http://localhost:9200/">
         <indexes>
            <index name="gorilla" config="index.config.js" />
         </indexes>
         <types>
            <type name="doc" index="gorilla" keyfield="_id" datefield="lastmod" />  
         </types>

      </endpoint>
      <endpoint name="mail" type="htmldatasource#MailEndPoint" limit="1"/>
   </endpoints>

   <converters>
      <converter name="double" decimalsep="," groupsep="."/>
      <converter name="date"   utc="true" formats="yyyyMMdd"/>
      <converter name="lower" />
      <converter name="upper" />
      <converter name="trim" />
   </converters>

   <pipelines>
      <pipeline name="gorilla" trace="false" converters="trim" endpoint="es.gorilla.doc">
         <action key="record" add="*" />
         <action key="record/name" field="name" converters="trim" />
         <action key="record/_preparehistory" emitexisting="history" destination="datasource"/>
         <template expr="record/(price.*)" field="$1" converters="double"/>
         <template expr="record/(.*)" field="$1" />
      </pipeline>
      
      <pipeline name="gorillaMail" trace="false" converters="trim" endpoint="mail.mail">
         <action key="record" add="*" />
         <action key="record/name" field="name" converters="trim" />
         <template expr="record/(price.*)" field="$1" converters="double"/>
         <template expr="record/(.*)" field="$1" />
      </pipeline>
   </pipelines>

   <datasources>
      <datasource name="gorillaMail" type="HtmlDatasource#BeursGorilla.BeursGorillaDS" trim="true" pipeline="gorillaMail" history="false">
         <provider type="UrlFeeder" baseurl="http://www.beursgorilla.nl/" >
            <url exchange="aex">aex.asp</url>
            <url exchange="amx">amx.asp</url>
         </provider>   
      </datasource>
      <datasource name="gorilla" active="false" type="HtmlDatasource#BeursGorilla.BeursGorillaDS" trim="true" pipeline="gorilla">
         <provider type="UrlFeeder" baseurl="http://www.beursgorilla.nl/" >
            <url exchange="aex">aex.asp</url>
            <url exchange="amx">amx.asp</url>
         </provider>   
            <url>amx.asp</url>
            <url>koers.asp</url>
            <aurl>lokaal.asp?b=a-d</aurl>
      </datasource>
   </datasources>
   
</root>
