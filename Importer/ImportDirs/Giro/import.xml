<?xml version="1.0" encoding="utf-8" ?>
<root importflags="fullimport">
   <script file="script.cs" />
   <endpoints>
      <endpoint name="es" type="ESEndpoint" url="http://localhost:9200/" cache="500" maxparallel="2">
         <index name="peter" indexname="gpeter" config="index.config.js" >
            <type name="doc" _keyfield="_id" />  
         </index>
         <index name="francien"   config="index.config.js" >
            <type name="doc" _keyfield="_id" />  
         </index>
         <index name="wilma"  config="index.config.js" >
            <type name="doc" _keyfield="_id" />  
         </index>
         <index name="bitmanager"  config="index.config.js" >
            <type name="doc" _keyfield="_id" />  
         </index>
      </endpoint>
   </endpoints>
   
   <categories>
      <collection name="all">
         <category cat="self" dstfield="cat" >
            <select field="name" expr="weerd.*" />
            <category cat="sparen" dstfield="cat" >
               <and>
                  <select field="name" contains="pj" />
               </and>
            </category>   
         </category>   
      </collection>
   </categories>

   <converters>
      <converter name="double" decimalsep="," groupsep="."/>
      <converter name="dateonly" utc="true" formats="yyyyMMdd"/>
      <converter name="lower" />
      <converter name="upper" />
      <converter name="trim" />
      <converter name="descrepl" type="replaceConverter" >
         <replace expr="Oplaaddatum/, tijd" repl="Oplaaddatum/tijd" />
         <replace expr="N, Htransactiedatum" repl="NH, Transactiedatum" />
      </converter>
   </converters>
   
   
   <pipelines>
      <pipeline name="giro" _converters="trim" script="ScriptExtension" >
         <action key="_item/_start" script="OnDSStart"/>
         <action key="record" add="*" script="OnAdd" categories="all"/>
         <action key="record/f0" field="date"/>
         <action key="record/f1" field="name"  script="SaveName"/>
         <action key="record/f2" field="account" flags="toarray|SkipEmpty"/>
         <action key="record/f3" field="account_other"  flags="toarray|SkipEmpty"/>
         <action key="record/ibanfromdesc" field="account_other"  flags="toarray|SkipEmpty"/>
         <action key="record/f4" field="mutation_code"/>
         <action key="record/f5" field="type"/>
         <action key="record/f6" field="amount_str" />
         <action key="record/f6" field="amount" converters="double" />
         <action key="record/f7" field="mutation"/>
         <action key="record/f8" field="comment" converters="descrepl" script="OnDescription"/>
         <action key="record/f8" field="raw_comment" />
      </pipeline>
   </pipelines>

   <datasources endpoint="es.*">
      <datasource name="bitmanager"  type="csv" trim="All" active="false" file="bitmanager\*.csv"  headers="true" dlm="," quote='"'/>
      <datasource name="peter"  type="csv" trim="All" active="false" file="peter\*.csv"  headers="true" dlm="," quote='"'/>
      <datasource name="francien"  type="csv" trim="All" active="false" file="francien\*.csv"  headers="true" dlm="," quote='"'/>
      <datasource name="wilma"  type="csv" trim="All" active="false" file="wilma\*.csv"  headers="true" dlm="," quote='"'/>
   </datasources>
   
</root>
